<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC
"-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="productMapper">



			<resultMap id="resultProduct" type="Product">
			<id column="product_seq_id" property="product_seq_id"/>
			<result column="business_number" property="business_number"/>
			<result column="thumb_url" property="thumb_url"/>
			<result column="product_name" property="product_name"/>
			<result column="price" property="price"/>
			<result column="stock" property="stock"/>
			<result column="claims_num" property="claims_num"/>
			<result column="create_at" property="create_at"/>
			<result column="modified_at" property="modified_at"/>		
			<result column="admin_inspection" property="admin_inspection"/>
			<result column="tag" property="tag"/>
			<result column="original_filepath" property="original_filepath"/>
			<result column="rename_filepath" property="rename_filepath"/>
			<result column="content" property="content"/>
			<result column="product_no" property="product_no"/>					
			</resultMap>
			
			
			
			
			<resultMap id="resultUserProduct" type="Product">
			<id column="product_seq_id" property="product_seq_id"/>		
			<result column="product_name" property="product_name"/>
			<result column="price" property="price"/>
			<result column="rename_filepath" property="rename_filepath"/>		
			</resultMap>
	
	

<!-- 상품 리스트 전체 목록 -->
	<select id="selectAll" resultMap="resultProduct">
	select * from product
	order by product_seq_id desc </select>



<!-- 유저 상품 리스트 목록 -->
<select id="selectUserAll" resultMap="resultUserProduct">
	select * from product
	order by product_seq_id desc </select>



<!-- 상품명검색select -->
 <select id="selectSearchProductName" resultMap="resultProduct" parameterType="string">
select * from product
where product_name like '%' || #{ keyword } || '%'
order by modified_at desc 
</select> 




<!-- 상품 상세보기 요청 처리용 , 상품 수정 -->
 <select id="selectProduct" resultMap="resultProduct" parameterType="_int">
		select * from product
		where product_no = #{ product_no }
</select> 


<!-- 상품 상세보기 요청 처리용 , 상품 수정 -->
 <select id="selectNameProduct" resultMap="resultProduct" parameterType="string">
		select * from product
		where product_name = #{ product_name }
</select> 




	<update id="updateProduct" parameterType="Product">
		update product
		set product_name = #{ product_name }
			, price = #{ price }
			, stock = #{ stock }
			, tag = #{ tag }
			<if test="original_filepath != null">
		    , original_filepath = #{ original_filepath }
		    , rename_filepath = #{ rename_filepath }
		    </if>
		    <if test="original_filepath == null">
		    , original_filepath = null
		    , rename_filepath = null
		    </if>
		    , modified_at = sysdate
		    , content = #{ content }	   
			where product_no = #{ product_no }
	</update> 















	<delete id="deleteProduct" parameterType="_int">
		delete from product
		where product_seq_id = #{ product_seq_id }
	</delete> 





	
	

<!-- <insert id="insertProduct" parameterType="Product">
insert into product (product_seq_id, business_number, thumb_url, product_name, 
					price, stock, claims_num, CREATE_AT, modified_at, admin_inspection, tag,
					original_filepath, rename_filepath, content, product_no)
values ( product_seq_id.nextval, #{business_number}, #{ thumb_url },
 		#{ product_name }, #{ price }, #{ stock }, #{ claims_num }, sysdate, sysdate, DEFAULT, 
 		#{ tag }, #{ original_filepath, jdbcType=VARCHAR }, #{ rename_filepath, jdbcType=VARCHAR },
#{ content }, (select max(product_no) + 1 from product))
</insert>
 -->

<insert id="insertProduct" parameterType="Product">
    insert into product ( business_number, thumb_url, product_name, 
                          price, stock, claims_num, CREATE_AT, modified_at, admin_inspection, tag,
                          original_filepath, rename_filepath, content, product_no)
    values ( 
            #{business_number}, 
            #{thumb_url}, 
            #{product_name}, 
            #{price},
            #{stock},  
            #{claims_num},
            sysdate, 
            sysdate, 
            DEFAULT, 
            #{tag}, 
            #{original_filepath,jdbcType=VARCHAR}, 
            #{rename_filepath,jdbcType=VARCHAR}, 
            #{content}, 
            (select nvl(max(product_no), 0) + 1 from product))
</insert>



<!-- 
<select id="selectSearchWriter" parameterType="string" resultMap="resultNotice">
select * from notice
where noticewriter like '%' || #{ keyword } || '%'
order by noticeno desc
</select>

<select id="selectSearchDate" parameterType="SearchDate" resultMap="resultNotice">
select * from notice
where noticedate between #{ begin } - 1 and #{ end } + 1
order by noticeno desc</select>

<select id="selectLast">
</select>


<update id="updateNotice" parameterType="Notice">
update notice
set noticetitle = #{ noticetitle },noticecontent = #{ noticecontent },
noticedate = sysdate
<if test="original_filepath != null">
, original_filepath = #{ original_filepath }, rename_filepath = #{ rename_filepath }
</if>
<if test="original_filepath == null">
, original_filepath = null, rename_filepath = null
</if>
where noticeno = #{ noticeno }
</update>

<delete id="deleteNotice" parameterType="_int">
delete from noticewhere noticeno = #{ noticeno }
</delete> -->

</mapper>